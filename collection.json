{
  "info": {
    "name": "apikit playground",
    "description": "CRUD API for Users — built with github.com/KARTIKrocks/apikit",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "1",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health",
      "item": [
        {
          "name": "Readiness",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/health",
            "description": "Full health check — returns status of all dependencies"
          }
        },
        {
          "name": "Liveness",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/health/live",
            "description": "Liveness probe — always returns 200 if the process is up"
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "List Users",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/v1/users?page=1&per_page=10&sort=-created_at",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "users"],
              "query": [
                { "key": "page",     "value": "1" },
                { "key": "per_page", "value": "10" },
                { "key": "sort",     "value": "-created_at", "description": "Prefix with - for DESC. Allowed: id, name, email, created_at" }
              ]
            },
            "description": "List all users with pagination and sorting"
          }
        },
        {
          "name": "List Users — filtered by role",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/v1/users?page=1&per_page=10&filter[role]=admin",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "users"],
              "query": [
                { "key": "page",          "value": "1" },
                { "key": "per_page",      "value": "10" },
                { "key": "filter[role]",  "value": "admin", "description": "Allowed: admin, user, mod" }
              ]
            },
            "description": "List users filtered by role"
          }
        },
        {
          "name": "List Users — filtered by active",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/v1/users?filter[active]=true",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "users"],
              "query": [
                { "key": "filter[active]", "value": "true", "description": "true or false" }
              ]
            },
            "description": "List only active users"
          }
        },
        {
          "name": "Get User",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/api/v1/users/{{user_id}}",
            "description": "Get a single user by ID"
          }
        },
        {
          "name": "Create User",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/api/v1/users",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Alice Smith\",\n  \"email\": \"alice@example.com\",\n  \"role\": \"user\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Create a new user. role must be one of: admin, user, mod"
          }
        },
        {
          "name": "Create Admin User",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/api/v1/users",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Bob Admin\",\n  \"email\": \"bob@example.com\",\n  \"role\": \"admin\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Create an admin user"
          }
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/api/v1/users/{{user_id}}",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Alice Updated\",\n  \"role\": \"mod\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Update a user. All fields are optional — only provided fields are updated"
          }
        },
        {
          "name": "Deactivate User",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/api/v1/users/{{user_id}}",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"active\": false\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Deactivate a user"
          }
        },
        {
          "name": "Delete User",
          "request": {
            "method": "DELETE",
            "url": "{{base_url}}/api/v1/users/{{user_id}}",
            "description": "Permanently delete a user by ID"
          }
        }
      ]
    },
    {
      "name": "Error Cases",
      "item": [
        {
          "name": "Create User — missing fields",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/api/v1/users",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"A\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Triggers 422 validation error — name too short, email missing, role missing"
          }
        },
        {
          "name": "Create User — invalid role",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/api/v1/users",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Alice\",\n  \"email\": \"alice2@example.com\",\n  \"role\": \"superuser\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Triggers 422 — role must be admin, user, or mod"
          }
        },
        {
          "name": "Get User — not found",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/api/v1/users/99999",
            "description": "Triggers 404 NOT_FOUND"
          }
        },
        {
          "name": "Create User — duplicate email",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/api/v1/users",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Alice Duplicate\",\n  \"email\": \"alice@example.com\",\n  \"role\": \"user\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "description": "Triggers 409 CONFLICT — email already exists (run Create User first)"
          }
        }
      ]
    }
  ]
}
